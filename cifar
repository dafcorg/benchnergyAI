from torchvision.datasets import CIFAR10

def get_dataloaders_cifar10(batch_size, num_workers):
    normalize = transforms.Normalize(
        mean=[0.485, 0.456, 0.406],
        std=[0.229, 0.224, 0.225],
    )

    train_tfms = transforms.Compose([
        transforms.Resize(224),               # ðŸ”¥ escalamos CIFAR-10 de 32x32 a 224x224
        transforms.RandomHorizontalFlip(),
        transforms.ToTensor(),
        normalize,
    ])

    val_tfms = transforms.Compose([
        transforms.Resize(224),
        transforms.ToTensor(),
        normalize,
    ])

    train_ds = CIFAR10(root="./cifar10", train=True, download=True, transform=train_tfms)
    val_ds   = CIFAR10(root="./cifar10", train=False, download=True, transform=val_tfms)

    train_loader = DataLoader(train_ds, batch_size=batch_size, shuffle=True,
                              num_workers=num_workers, pin_memory=True)

    val_loader   = DataLoader(val_ds, batch_size=batch_size, shuffle=False,
                              num_workers=num_workers, pin_memory=True)

    num_classes = 10
    return train_loader, val_loader, num_classes
